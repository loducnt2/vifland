document.addEventListener("DOMContentLoaded", () => {
    loadLogoAni();
    toggleMenuMobile();
    moveNavitem();
    checkLayoutBanner();
    checkHome();
    clickbuttonboloc();
    toggleUserMobile();
    checkContentVip();
    toggleUserLogin();
    //checkFavorites();
    showPassword();
    getValueVip();
    nhapInputImg();
    clickThongBao();
    changeTextTime();
    CheckActivePage();
    CheckAdminTopBar();
    checktablink();
});
const checktablink = () => {
    $("#thaydoimk-link").click(function () {
        window.location.href = "";
    });
};
const CheckActivePage = () => {
    var path = window.location.href; // because the 'href' property of the DOM element is the absolute path
    $(".user-admin a").each(function () {
        if (this.href === path) {
            $(this).addClass("active");
        }
    });
    $(".box-left-admin a").each(function () {
        if (this.href === path) {
            $(this).addClass("active");
        }
    });
};
const CheckAdminTopBar = () => {
    if ($(".top-bar-admin").length >= 1) {
        $(".user-login").css("top", "140px");
    } else {
        $(".user-login").css("top", "100px");
    }
};
const changeTextTime = () => {
    $(".mdtp__am").text("Sáng");
    $(".mdtp__pm").text("Tối");
    $(".mdtp__buttons .cancel").text("HỦY");
    $(".mdtp__buttons .ok").text("XÁC NHẬN");
};
const nhapInputImg = () => {
    (function ($) {
        $.fn.attachmentUploader = function () {
            const uploadControl = $(this).find(".js-form-upload-control");
            const btnClear = $(this).find(".btn-clear");
            $(uploadControl).on("change", function (e) {
                const preview = $(this)
                    .closest(".form-upload")
                    .children(".form-upload__preview");
                const files = e.target.files;

                function previewUpload(file) {
                    if (/\.(jpe?g|png|gif)$/i.test(file.name)) {
                        var reader = new FileReader();
                        reader.addEventListener(
                            "load",
                            function () {
                                const html =
                                    '<div class="form-upload__item">' +
                                    '<div class="form-upload__item-thumbnail" style="background-image: url(' +
                                    this.result +
                                    ')"></div>' +
                                    '<p class="form-upload__item-name">' +
                                    file.name +
                                    "</p>" +
                                    "</div>";
                                preview.append(html);
                                btnClear.show();
                            },
                            false
                        );
                        reader.readAsDataURL(file);
                    } else {
                        alert("Please upload image only");
                        uploadControl.val("");
                    }
                }

                [].forEach.call(files, previewUpload);

                btnClear.on("click", function () {
                    $(".form-upload__item").remove();
                    uploadControl.val("");
                    $(this).hide();
                    return false;
                });
            });
        };
    })(jQuery);

    $(".form-upload").attachmentUploader();
};

function slideNav() {
    $(".sb-topnav button").on("click", function () {
        // $("#layoutSidenav #layoutSidenav_nav").toggleClass("active");
        $("#layoutSidenav #layoutSidenav_nav").toggleClass("active");
    });
}
const clickThongBao = () => {
    $(".wrap-list-thongbao").hide();
    $(".thong-bao-num").click(function () {
        $(".wrap-list-thongbao").slideToggle();
    });
    $(".close-tb").click(function () {
        $(".wrap-list-thongbao").slideToggle();
    });
};

const toggleMenuMobile = () => {
    $(".toggle-menu").on("click", function () {
        $(".menu-mobile").toggleClass("active");
        $("body").toggleClass("disabled");
        $(".bg-menu").toggleClass("active");
    });
    $(".close-button").on("click", function () {
        $(".menu-mobile").toggleClass("active");
        $("body").toggleClass("disabled");
        $(".bg-menu").toggleClass("active");
    });
};
const toggleUserMobile = () => {
    $(".user-menu").on("click", function () {
        $(".user-mobile").toggleClass("active");
        $("body").toggleClass("disabled");
        $(".bg-menu").toggleClass("active");
    });
    $(".close-button-2").on("click", function () {
        $(".user-mobile").toggleClass("active");
        $("body").toggleClass("disabled");
        $(".bg-menu").toggleClass("active");
    });
};
const showPassword = () => {
    $("#showpass").click(function () {
        const text = $(this).text();
        if (text == "visibility") {
            $(this).text("visibility_off");
        } else {
            $(this).text("visibility");
        }
    });
};
/*const checkFavorites = () => {
    $(".icons").click(function() {
        $(this).toggleClass("active");
        if ($(this).hasClass("ri-heart-line")) {
            $(this).addClass("ri-heart-fill");
            $(this).removeClass("ri-heart-line");
        } else if ($(this).hasClass("ri-heart-fill")) {
            $(this).addClass("ri-heart-line");
            $(this).removeClass("ri-heart-fill");
        }
    });
};*/
const toggleUserLogin = () => {
    $(".avatar-user").on("click", function () {
        $(".user-login").toggleClass("active");
    });
    $(".close-button-3").on("click", function () {
        $(".user-login").toggleClass("active");
    });
    $("main").on("click", function () {
        $(".user-login").removeClass("active");
    });
};

function moveNavitem() {
    if ($(window).width() <= 1024) {
        $(".icon > #desktop").appendTo("nav .nav-mobile");
    } else {
        $(".icon > #desktop").appendTo(".main-nav>.nav .icon");
    }
}
const clickbuttonboloc = () => {
    $(".wrap-3 .title").on("click", function () {
        $(this)
            .next()
            .slideToggle();
    });
};
//Slide banner
var swiperhomebanner = new Swiper(".slideSpHome", {
    slidesPerView: 5,
    spaceBetween: 17,
    allowSlidePrev: false,
    allowSlideNext: false,
    breakpoints: {
        575: {
            slidesPerView: 1.2,
            spaceBetween: 10,
            allowSlidePrev: true,
            allowSlideNext: true
        },
        640: {
            slidesPerView: 1.7,
            spaceBetween: 10,
            allowSlidePrev: true,
            allowSlideNext: true
        },
        768: {
            slidesPerView: 2.2,
            spaceBetween: 10,
            allowSlidePrev: true,
            allowSlideNext: true
        },
        1024: {
            slidesPerView: 2.5,
            cssMode: true,
            mousewheel: true,
            keyboard: true,
            spaceBetween: 10,
            allowSlidePrev: true,
            allowSlideNext: true
        },
        1440: {
            slidesPerView: 4,
            spaceBetween: 10
        }
    }
});
//Slide banner
var bannerMain = new Swiper(".slide-banner .swiper-container", {
    slidesPerView: 2.5,
    loop: true,
    spaceBetween: 30,
    loopFillGroupWithBlank: true,
    autoplay: {
        delay: 2500,
        disableOnInteraction: false
    }
});
//Check banner
const checkLayoutBanner = () => {
    const pagesBanner = $("#page-banner");
    const breadcrumb = $(".global-breadcrumb");
    const heightHeader = $("header").outerHeight();
    const mainBanner = $("#home-banner");

    if (mainBanner.length < 1 && $(window).width() >= 1024) {
        pagesBanner.css("padding-top", heightHeader + 13);
    } else {
        mainBanner.css("padding-top", heightHeader + 13);
    }
    if (mainBanner.length < 1 && pagesBanner.length < 1) {
        $("main").css("padding-top", heightHeader);
    }
};
const checkHome = () => {
    const mainHome = $("#home");
    if (mainHome.length >= 1) {
        $("header").css("position", "unset");
        $("main").css("padding-top", 0);
        $(".nav-mobile").css("padding-bottom", 80);
    }
};
// input[name='type']:checked
const getValueVip = () => {
    var form = $(".formDangBaiViet"),
        elements = form.find(' input[name="type"], select'),
        totalEl = $(".total"),
        priceBase = $(".priceBase");
    var phantram123 = $(".phantram");
    var inputTotalPrice = $("input[name='totalPriceVip']");
    //function to calculate total
    var calculateTotal = function () {
        if ($(window).width() <= 1024) {
            var vip = parseInt($("#select-vip-all option:selected").val());
        } else {
            var vip = $("input[name='type']:checked").val();
        }

        var date = parseInt($(".selectNgay option:selected").val());
        var priceVip1 = $("#value-vip-1").val();
        var priceVip2 = $("#value-vip-2").val();
        var priceVip3 = $("#value-vip-3").val();
        var total = 0;

        if (vip == 1) {
            if (date == 7) {
                var money = priceVip1 * date;
                var khuyenmai = priceVip1 * date * 0.05;
                var phantram = 5;
                total = money - khuyenmai;
            } else if (date == 15) {
                var money = priceVip1 * date;
                var khuyenmai = priceVip1 * date * 0.1;
                var phantram = 10;
                total = money - khuyenmai;
            } else if (date == 30) {
                var money = priceVip1 * date;
                var khuyenmai = priceVip1 * date * 0.15;
                var phantram = 15;
                total = money - khuyenmai;
            } else {
                var money = priceVip1 * date;
                var khuyenmai = priceVip1 * date * 0.2;
                var phantram = 20;
                total = money - khuyenmai;
            }
        } else if (vip == 2) {
            if (date == 7) {
                var money = priceVip2 * date;
                var khuyenmai = priceVip2 * date * 0.05;
                var phantram = 5;
                total = money - khuyenmai;
            } else if (date == 15) {
                var money = priceVip2 * date;
                var khuyenmai = priceVip2 * date * 0.1;
                var phantram = 10;
                total = money - khuyenmai;
            } else if (date == 30) {
                var money = priceVip2 * date;
                var khuyenmai = priceVip2 * date * 0.15;
                var phantram = 15;
                total = money - khuyenmai;
            } else {
                var money = priceVip2 * date;
                var khuyenmai = priceVip2 * date * 0.2;
                var phantram = 20;
                total = money - khuyenmai;
            }
        } else if (vip == 3) {
            if (date == 7) {
                var money = priceVip3 * date;
                var khuyenmai = priceVip3 * date * 0.05;
                var phantram = 5;
                total = money - khuyenmai;
            } else if (date == 15) {
                var money = priceVip3 * date;
                var khuyenmai = priceVip3 * date * 0.1;
                var phantram = 10;
                total = money - khuyenmai;
            } else if (date == 30) {
                var money = priceVip3 * date;
                var khuyenmai = priceVip3 * date * 0.15;
                var phantram = 15;
                total = money - khuyenmai;
            } else {
                var money = priceVip3 * date;
                var khuyenmai = priceVip3 * date * 0.2;
                var phantram = 20;
                total = money - khuyenmai;
            }
        } else {
            money = 0;
            total = 0;
        }
        money = money.toLocaleString("it-IT", {
            style: "currency",
            currency: "VND"
        });
        totalPrice = total.toLocaleString("it-IT", {
            style: "currency",
            currency: "VND"
        });
        phantram123.text(phantram);
        totalEl.text(totalPrice);
        priceBase.text(money);
        inputTotalPrice.val(total);

        //Huy
        $("input[name='pricePost']").val(total);
    };
    elements.on("change keyup", calculateTotal);
};
const checkContentVip = () => {
    // var checkValue = $("input[name='vip']").val();
    var form = $(".formDangBaiViet"),
        elements = form.find(' input[name="type"], select');
    const showContentVip = () => {
        if ($(window).width() <= 1024) {
            let ketqua = $("#select-vip-all option:selected").val();
            if (ketqua == 1) {
                $("#vip1-ct")
                    .addClass("active")
                    .siblings()
                    .removeClass("active");
                $("#sub-vip1")
                    .addClass("active")
                    .siblings()
                    .removeClass("active");
            } else if (ketqua == 2) {
                $("#vip2-ct")
                    .addClass("active")
                    .siblings()
                    .removeClass("active");
                $("#sub-vip2")
                    .addClass("active")
                    .siblings()
                    .removeClass("active");
            } else if (ketqua == 3) {
                $("#vip3-ct")
                    .addClass("active")
                    .siblings()
                    .removeClass("active");
                $("#sub-vip3")
                    .addClass("active")
                    .siblings()
                    .removeClass("active");
            } else {
                $("#tinthuong-ct")
                    .addClass("active")
                    .siblings()
                    .removeClass("active");
                $("#sub-vip1").removeClass("active");
                $("#sub-vip2").removeClass("active");
                $("#sub-vip3").removeClass("active");
            }
        } else {
            $("input[name='type']").click(function () {
                var ketqua = $(this).val();
                if (ketqua == 1) {
                    $("#vip1-ct")
                        .addClass("active")
                        .siblings()
                        .removeClass("active");
                    $("#sub-vip1")
                        .addClass("active")
                        .siblings()
                        .removeClass("active");
                } else if (ketqua == 2) {
                    $("#vip2-ct")
                        .addClass("active")
                        .siblings()
                        .removeClass("active");
                    $("#sub-vip2")
                        .addClass("active")
                        .siblings()
                        .removeClass("active");
                } else if (ketqua == 3) {
                    $("#vip3-ct")
                        .addClass("active")
                        .siblings()
                        .removeClass("active");
                    $("#sub-vip3")
                        .addClass("active")
                        .siblings()
                        .removeClass("active");
                } else {
                    $("#tinthuong-ct")
                        .addClass("active")
                        .siblings()
                        .removeClass("active");
                    $("#sub-vip1").removeClass("active");
                    $("#sub-vip2").removeClass("active");
                    $("#sub-vip3").removeClass("active");
                }
            });
        }
    };
    elements.on("change keyup", showContentVip);

};
// Trang tuyển dụng
jQuery(document).ready(function ($) {
    var alterClass = function () {
        var ww = document.body.clientWidth;
        if (ww < 1200) {
            $(".tuyendung-col").removeClass("pr-0");
        } else if (ww >= 1200) {
            $(".tuyendung-col").addClass("pr-0");
        }
    };
    $(window).resize(function () {
        alterClass();
    });
    alterClass();
});

jQuery(document).ready(function ($) {
    var alterClass = function () {
        var ww = document.body.clientWidth;
        if (ww < 1200) {
            $(".tuyendung-col-2").removeClass("pl-0");
        } else if (ww >= 1200) {
            $(".tuyendung-col-2").addClass("pl-0");
        }
    };
    $(window).resize(function () {
        alterClass();
    });
    alterClass();
});
// CLick thay đổi ngôn ngữ
$(function () {
    //run when the DOM is ready
    $(".button-change-lang").click(function () {
        //use a class, since your ID gets mangled
        $(".list-change-lang").toggleClass("active"); //add the class to the clicked element
    });
});
// Click mở rộng content
$(function () {
    //run when the DOM is ready
    $("#xemthem").click(function () {
        //use a class, since your ID gets mangled
        $(".content-box").toggleClass("toggle"); //add the class to the clicked element
        var text = $("#xemthem").text();
        if (text == "Xem thêm") {
            $("#xemthem").text("Rút gọn");
        } else {
            $("#xemthem").text("Xem thêm");
        }
    });
});
$(function () {
    $('[data-toggle="tooltip"]').tooltip();
});
// Trang sản phẩm
var sanpham_slider = new Swiper(".sanpham-slider.swiper-container", {
    slidesPerView: 3,
    spaceBetween: 0,
    slidesPerGroup: 3,
    // loop: true,
    loopFillGroupWithBlank: true,
    pagination: {
        el: ".swiper-pagination",
        clickable: true
    },
    navigation: {
        nextEl: ".swiper-button-next",
        prevEl: ".swiper-button-prev"
    },
    breakpoints: {
        1280: {
            slidesPerView: 2
        }
    }
});
var sanpham_slider_relate = new Swiper(".article-wrapper.swiper-container", {
    slidesPerView: 4.5,
    spaceBetween: 30,
    slidesPerGroup: 1,
    loop: true,
    loopFillGroupWithBlank: true,
    navigation: {
        nextEl: ".swiper-button-next",
        prevEl: ".swiper-button-prev"
    },
    pagination: {
        el: ".swiper-pagination",
        clickable: true
    },
    breakpoints: {
        768: {
            slidesPerView: 1.5
        },
        1280: {
            slidesPerView: 2.5
        },
        1600: {
            slidesPerView: 3.5
        }
    }
});
// focus form
// Offset thẻ a
$("a").on("click", function (event) {
    // Make sure this.hash has a value before overriding default behavior
    if (this.hash !== "") {
        // Prevent default anchor click behavior
        event.preventDefault();

        // Store hash
        var hash = this.hash;

        // Using jQuery's animate() method to add smooth page scroll
        // The optional number (800) specifies the number of milliseconds it takes to scroll to the specified area
        $("html, body").animate({
            scrollTop: $(hash).offset().top - 120
        },

            800
        );
    } // End if
});
// Part select
$(document).ready(function () {
    $(".select1").select2();
    $(".selectNgay").select2({
        minimumResultsForSearch: -1
    });
    $(".sltp").select2({
        placeholder: "Tỉnh/ Thành"
    });
    $(".slnhadat").select2({
        placeholder: "Loại nhà đất"
    });
    $(".slgia").select2({
        placeholder: "Khoảng giá"
    });
    $(".sluser").select2({
        placeholder: "Tất cả đối tượng"
    });
    $(".sltinhinh").select2({
        placeholder: "Tin đăng có ảnh, video"
    });
    $(".slbaidang").select2({
        placeholder: "Lọc tin đăng mới nhất"
    });
    $(".sltrangthai").select2({
        placeholder: "Trạng thái"
    });
    $(".slloaitin").select2({
        placeholder: "Loại tin"
    });
    $(".slloaitin2").select2({
        placeholder: "Loại tin nha"
    });
});
// Logo animation
const loadLogoAni = () => {
    if (!sessionStorage.getItem("doNotShow")) {
        sessionStorage.setItem("doNotShow", true);
        $(window).on("load", function () {
            var preload = $(".logo_animation")
                .delay(3000)
                .queue(function (next) {
                    $(this).addClass("preload");
                    next();
                });
            var preload_2 = $("html")
                .delay(3000)
                .queue(function (next) {
                    $(this).removeClass("overflow-hidden");
                    next();
                });
            var preload_3 = $(".logo_animation img")
                .delay(1500)
                .queue(function (next) {
                    $(this).addClass("d-block");
                    next();
                });
        });
    } else {
        $(".logo_animation")
            .hide()
            .fadeOut(1500);
        $("html").removeClass("overflow-hidden");
    }
};